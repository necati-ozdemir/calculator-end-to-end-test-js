pipeline {
  agent {
    label 'master'
  }

  tools{
    nodejs "NodeJS"
  }

  options {
    buildDiscarder(logRotator(numToKeepStr: '3'))
  }

  environment {
    NODE_VERSION = 'v8.12.0'
    PATH = "$PATH:/usr/local/bin"
  }

  stages {
    stage('Checkout') {
      steps {
        checkout scm
      }
    }
    stage('Get dependencies') {
      steps {
          sh 'npm install'
      }
    }
    stage('Execute') {
      steps {

          sh 'npm run upAndOpen'
          sh 'npm run compose-down'

      }
    }
  }

 // post {
   // always {
    //  junit keepLongStdio: true, testResults: 'test-results/*.xml', allowEmptyResults: true
     // archiveArtifacts artifacts: 'cypress/videos/**/*.mp4', onlyIfSuccessful: false
    //}
  //}
}
